---
import { getPostHog } from "@/hooks/usePostHog";

export interface Props {
  href: string;
  external?: boolean;
  class?: string;
  id?: string;
}

const { href, external = false, class: className = "", id } = Astro.props;

const isExternalLink = href == null || href.startsWith("http://") || href.startsWith("https://");
const isHashLink = href?.startsWith('#');
---

{isExternalLink ? (
  <a
    href={href}
    target="_blank"
    rel="noopener"
    class={className}
    id={id}
  >
    <slot />
  </a>
) : (
  <a
    href={href}
    class={className}
    id={id}
    onClick={() => {
      if (typeof window !== 'undefined' && window.posthog) {
        window.posthog.capture("link_clicked", {
          target: href,
          is_external: external,
          is_hash: isHashLink
        });
      }
    }}
  >
    <slot />
  </a>
)}